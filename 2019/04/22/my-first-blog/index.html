<!DOCTYPE HTML>
<html>

<head><meta name="generator" content="Hexo 3.8.0">
	<link rel="bookmark" type="image/x-icon" href="/img/logo_miccall.png">
	<link rel="shortcut icon" href="/img/logo_miccall.png">
	
			    <title>
    Harrison
    </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="stylesheet" href="/css/mic_main.css">
    <link rel="stylesheet" href="/css/dropdownMenu.css">
    <meta name="keywords" content="miccall">
    
    	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	 
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css">
    </noscript>
    <style type="text/css">
        body:before {
          content: ' ';
          position: fixed;
          top: 0;
          background: url('/img/bg.jpg') center 0 no-repeat;
          right: 0;
          bottom: 0;
          left: 0;
          background-size: cover; 
        }
    </style>

			    
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script async type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
	
</head>
    
		
<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_coy.css">
<link rel="stylesheet" href="/css/typo.css">
<!-- 文章页 -->
<body class="is-loading">
    <!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">欢迎步入</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special">
            <ul class="menu links">
			<!-- Homepage  主页  --> 
			<li>
	            <a href="/" rel="nofollow">主页</a>
	        </li>
			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1">分类</a>
	                    <ul class="submenu">
	                        <li>
	                        <a class="category-link" href="/categories/Algorithm/">Algorithm</a>
	                    </li></ul>
	        </li>
	        
	        <!-- archives  归档   --> 
	        
	        
		        <!-- Pages 自定义   -->
		        
		        <li>
		            <a href="/about/" title="介绍">
		                介绍
		            </a>
		        </li>
		        
		        <li>
		            <a href="/group/" title="团队">
		                团队
		            </a>
		        </li>
		        
		        <li>
		            <a href="/gallery/" title="收集">
		                收集
		            </a>
		        </li>
		        
		        <li>
		            <a href="/tag/" title="标签">
		                标签
		            </a>
		        </li>
		        


            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
                    
                    <li>
                        <a title="github" href="https://github.com/hanpoung" target="_blank" rel="noopener">
                            <i class="icon fa fa-github"></i>
                        </a>
                    </li>
                    
                    <li>
                        <a title="500px" href="http://500px.com" target="_blank" rel="noopener">
                            <i class="icon fa fa-500px"></i>
                        </a>
                    </li>
                    
                    <li>
                        <a title="facebook" href="https://github.com/hanpoung" target="_blank" rel="noopener">
                            <i class="icon fa fa-facebook"></i>
                        </a>
                    </li>
                    
			</ul>
</nav>

        <div id="main">
            <div class="post_page_title_img" style="height: 25rem;background-image: url(/images/antonina.jpg);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;">
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2>DOM事件机制</h2></a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <h2 id="DOM事件机制"><a href="#DOM事件机制" class="headerlink" title="DOM事件机制"></a>DOM事件机制</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>本文主要介绍DOM事件级别、DOM事件模型、事件流、事件代理和Event对象常见的应用，希望对你们有些帮助和启发！</p>
<h3 id="一、DOM事件级别"><a href="#一、DOM事件级别" class="headerlink" title="一、DOM事件级别"></a>一、DOM事件级别</h3><p>DOM级别一共可以分为四个级别：DOM0级、DOM1级、DOM2级和DOM3级。而DOM事件分为3个级别：DOM 0级事件处理，DOM 2级事件处理和DOM 3级事件处理。由于DOM 1级中没有事件的相关内容，所以没有DOM 1级事件。<br>1.DOM 0级事件</p>
<pre><code>el.onclick=function(){}
// 例1
var btn = document.getElementById(&#39;btn&#39;);
 btn.onclick = function(){
     alert(this.innerHTML);
 }
</code></pre><a id="more"></a>
<p>当希望为同一个元素/标签绑定多个同类型事件的时候（如给上面的这个btn元素绑定3个点击事件），是不被允许的。DOM0事件绑定，给元素的事件行为绑定方法，这些方法都是在当前元素事件行为的冒泡阶段(或者目标阶段)执行的。<br>2.DOM 2级事件<br>el.addEventListener(event-name, callback, useCapture)<br>event-name: 事件名称，可以是标准的DOM事件<br>callback: 回调函数，当事件触发时，函数会被注入一个参数为当前的事件对象 event<br>useCapture: 使用捕获。 默认是false，代表事件句柄在冒泡阶段执行<br>// 例2<br>var btn = document.getElementById(‘btn’);<br>btn.addEventListener(“click”, test, false);<br>function test(e){<br>    e = e || window.event;<br>    alert((e.target || e.srcElement).innerHTML);<br>    btn.removeEventListener(“click”, test)<br>}<br>//IE9-:attachEvent()与detachEvent()。<br>//IE9+/chrom/FF:addEventListener()和removeEventListener()<br>IE9以下的IE浏览器不支持 addEventListener()和removeEventListener()，使用 attachEvent()与detachEvent() 代替，因为IE9以下是不支持事件捕获的，所以也没有第三个参数，第一个事件名称前要加on。<br>3.DOM 3级事件<br>在DOM 2级事件的基础上添加了更多的事件类型。<br>UI事件，当用户与页面上的元素交互时触发，如：load、scroll<br>焦点事件，当元素获得或失去焦点时触发，如：blur、focus<br>鼠标事件，当用户通过鼠标在页面执行操作时触发如：dblclick、mouseup<br>滚轮事件，当使用鼠标滚轮或类似设备时触发，如：mousewheel<br>文本事件，当在文档中输入文本时触发，如：textInput<br>键盘事件，当用户通过键盘在页面上执行操作时触发，如：keydown、keypress<br>合成事件，当为IME（输入法编辑器）输入字符时触发，如：compositionstart<br>变动事件，当底层DOM结构发生变化时触发，如：DOMsubtreeModified<br>同时DOM3级事件也允许使用者自定义一些事件。<br>二、DOM事件模型和事件流<br>DOM事件模型分为捕获和冒泡。一个事件发生后，会在子元素和父元素之间传播（propagation）。这种传播分成三个阶段。<br>（1）捕获阶段：事件从window对象自上而下向目标节点传播的阶段；<br>（2）目标阶段：真正的目标节点正在处理事件的阶段；<br>（3）冒泡阶段：事件从目标节点自下而上向window对象传播的阶段。<br>DOM事件捕获的具体流程<br>图片: <a href="https://segmentfault.com/img/remote/1460000017259390?w=461&amp;h=243" target="_blank" rel="noopener">https://segmentfault.com/img/remote/1460000017259390?w=461&amp;h=243</a><br>捕获是从上到下，事件先从window对象，然后再到document（对象），然后是html标签（通过document.documentElement获取html标签），然后是body标签（通过document.body获取body标签），然后按照普通的html结构一层一层往下传，最后到达目标元素。<br>而事件冒泡的流程刚好是事件捕获的逆过程。<br>接下来我们看个事件冒泡的例子：<br>// 例3</p>
<p><div id="outer"><br>    <div id="inner"></div><br></div><br>……<br>window.onclick = function() {<br>    console.log(‘window’);<br>};<br>document.onclick = function() {<br>    console.log(‘document’);<br>};<br>document.documentElement.onclick = function() {<br>    console.log(‘html’);<br>};<br>document.body.onclick = function() {<br>    console.log(‘body’);<br>}<br>outer.onclick = function(ev) {<br>    console.log(‘outer’);<br>};<br>inner.onclick = function(ev) {<br>    console.log(‘inner’);<br>};<br>图片: <a href="https://segmentfault.com/img/remote/1460000017259391?w=568&amp;h=116" target="_blank" rel="noopener">https://segmentfault.com/img/remote/1460000017259391?w=568&amp;h=116</a><br>正如我们上面提到的onclick给元素的事件行为绑定方法都是在当前元素事件行为的冒泡阶段(或者目标阶段)执行的。<br>三、事件代理(事件委托)<br>由于事件会在冒泡阶段向上传播到父节点，因此可以把子节点的监听函数定义在父节点上，由父节点的监听函数统一处理多个子元素的事件。这种方法叫做事件的代理（delegation）。<br>1.优点<br>减少内存消耗，提高性能<br>假设有一个列表，列表之中有大量的列表项，我们需要在点击每个列表项的时候响应一个事件<br>// 例4</p>
<p><ul id="list"><br>  <li>item 1</li><br>  <li>item 2</li><br>  <li>item 3</li><br>  ……<br>  <li>item n</li><br></ul><br>如果给每个列表项一一都绑定一个函数，那对于内存消耗是非常大的，效率上需要消耗很多性能。借助事件代理，我们只需要给父容器ul绑定方法即可，这样不管点击的是哪一个后代元素，都会根据冒泡传播的传递机制，把容器的click行为触发，然后把对应的方法执行，根据事件源，我们可以知道点击的是谁，从而完成不同的事。<br>动态绑定事件<br>在很多时候，我们需要通过用户操作动态的增删列表项元素，如果一开始给每个子元素绑定事件，那么在列表发生变化时，就需要重新给新增的元素绑定事件，给即将删去的元素解绑事件，如果用事件代理就会省去很多这样麻烦。<br>2.如何实现事件代理<br>接下来我们来实现上例中父层元素 #list 下的 li 元素的事件委托到它的父层元素上：<br>// 给父层元素绑定事件<br>document.getElementById(‘list’).addEventListener(‘click’, function (e) {<br>  // 兼容性处理<br>  var event = e || window.event;<br>  var target = event.target || event.srcElement;<br>  // 判断是否匹配目标元素<br>  if (target.nodeName.toLocaleLowerCase === ‘li’) {<br>    console.log(‘the content is: ‘, target.innerHTML);<br>  }<br>});<br>四、Event对象常见的应用<br>event. preventDefault()<br>如果调用这个方法，默认事件行为将不再触发。什么是默认事件呢？例如表单一点击提交按钮(submit)跳转页面、a标签默认页面跳转或是锚点定位等。<br>很多时候我们使用a标签仅仅是想当做一个普通的按钮，点击实现一个功能，不想页面跳转，也不想锚点定位。<br>//方法一：<br><a href="javascript:;" target="_blank" rel="noopener">链接</a><br>也可以通过JS方法来阻止，给其click事件绑定方法，当我们点击A标签的时候，先触发click事件，其次才会执行自己的默认行为<br>//方法二:<br><a id="test" href="http://www.cnblogs.com" target="_blank" rel="noopener">链接</a></p>
<p><script><br>test.onclick = function(e){<br>    e = e || window.event;<br>    return false;<br>}<br></script><br>//方法三：<br><a id="test" href="http://www.cnblogs.com" target="_blank" rel="noopener">链接</a></p>
<p><script><br>test.onclick = function(e){<br>    e = e || window.event;<br>    e.preventDefault();<br>}<br></script><br>接下来我们看个例子：输入框最多只能输入六个字符，如何实现？<br>// 例5<br> <input type="text" id="tempInp"><br> <script><br>    tempInp.onkeydown = function(ev) {<br>        ev = ev || window.event;<br>        let val = this.value.trim() //trim去除字符串首位空格（不兼容）<br>        // this.value=this.value.replace(/^ +| +$/g,’’) 兼容写法<br>        let len = val.length<br>        if (len &gt;= 6) {<br>            this.value = val.substr(0, 6);<br>            //阻止默认行为去除特殊按键（DELETE\BACK-SPACE\方向键…）<br>            let code = ev.which || ev.keyCode;<br>            if (!/^(46|8|37|38|39|40)$/.test(code)) {<br>                ev.preventDefault()<br>            }<br>        }<br>    }<br> </script><br>event.stopPropagation() &amp; event.stopImmediatePropagation()<br>event.stopPropagation() 方法阻止事件冒泡到父元素，阻止任何父事件处理程序被执行。上面提到事件冒泡阶段是指事件从目标节点自下而上向window对象传播的阶段。<br>我们在例4的inner元素click事件上，添加event.stopPropagation()这句话后，就阻止了父事件的执行，最后只打印了’inner’。<br> inner.onclick = function(ev) {<br>    console.log(‘inner’);<br>    ev.stopPropagation();<br>};<br>stopImmediatePropagation 既能阻止事件向父元素冒泡，也能阻止元素同事件类型的其它监听器被触发。而 stopPropagation 只能实现前者的效果。我们来看个例子：</p>
<p><body><br>  <button id="btn">click me to stop propagation</button><br></body><br>……<br>const btn = document.querySelector(‘#btn’);<br>btn.addEventListener(‘click’, event =&gt; {<br>  console.log(‘btn click 1’);<br>  event.stopImmediatePropagation();<br>});<br>btn.addEventListener(‘click’, event =&gt; {<br>  console.log(‘btn click 2’);<br>});<br>document.body.addEventListener(‘click’, () =&gt; {<br>  console.log(‘body click’);<br>});<br>// btn click 1<br>如上所示，使用 stopImmediatePropagation后，点击按钮时，不仅body绑定事件不会触发，与此同时按钮的另一个点击事件也不触发。<br>event.target &amp; event.currentTarget<br>老实说这两者的区别，并不好用文字描述，我们先来看个例子：</p>
<p><div id="a"><br>  <div id="b"><br>    <div id="c"><br>      <div id="d"></div><br>    </div><br>  </div><br></div></p>
<p><script><br>  document.getElementById(‘a’).addEventListener(‘click’, function(e) {<br>    console.log(<br>      ‘target:’ + e.target.id + ‘&amp;currentTarget:’ + e.currentTarget.id<br>    )<br>  })<br>  document.getElementById(‘b’).addEventListener(‘click’, function(e) {<br>    console.log(<br>      ‘target:’ + e.target.id + ‘&amp;currentTarget:’ + e.currentTarget.id<br>    )<br>  })<br>  document.getElementById(‘c’).addEventListener(‘click’, function(e) {<br>    console.log(<br>      ‘target:’ + e.target.id + ‘&amp;currentTarget:’ + e.currentTarget.id<br>    )<br>  })<br>  document.getElementById(‘d’).addEventListener(‘click’, function(e) {<br>    console.log(<br>      ‘target:’ + e.target.id + ‘&amp;currentTarget:’ + e.currentTarget.id<br>    )<br>  })<br></script><br>图片: <a href="https://segmentfault.com/img/remote/1460000017259392?w=887&amp;h=245" target="_blank" rel="noopener">https://segmentfault.com/img/remote/1460000017259392?w=887&amp;h=245</a><br>当我们点击最里层的元素d的时候，会依次输出:<br>target:d&amp;currentTarget:d<br>target:d&amp;currentTarget:c<br>target:d&amp;currentTarget:b<br>target:d&amp;currentTarget:a<br>从输出中我们可以看到，event.target指向引起触发事件的元素，而event.currentTarget则是事件绑定的元素，只有被点击的那个目标元素的event.target才会等于event.currentTarget。也就是说，<br>event.currentTarget始终是监听事件者而，<br>event.target是事件的真正发出者。</p>

            </div>

            <!-- Post Comments -->
            
    <!-- 使用 DISQUS_CLICK -->
<div id="disqus-comment">
    <div id="disqus_thread"></div>

<!-- add animation -->
<style>
	.disqus_click_btn {
            line-height: 30px;
            margin: 0;
            min-width: 50px;
            padding: 0 14px;
            display: inline-block;
            font-family: "Roboto", "Helvetica", "Arial", sans-serif;
            font-size: 14px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0;
            overflow: hidden;
            will-change: box-shadow;
            transition: box-shadow .2s cubic-bezier(.4, 0, 1, 1), background-color .2s cubic-bezier(.4, 0, .2, 1), color .2s cubic-bezier(.4, 0, .2, 1);
            outline: 0;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            vertical-align: middle;
            border: 0;
            background: rgba(158, 158, 158, .2);
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);
            color: #fff;
            background-color: #7EC0EE;
            text-shadow: 0
        }
</style>
	
<div class="btn_click_load" id="disqus_bt"> 
    <button class="disqus_click_btn">点击查看评论</button>
</div>

<!--
<script type="text/javascript">
$('.btn_click_load').click(function() {
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'http-miccall-tech'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    document.getElementById('disqus_bt').style.display = "none";
});
</script>
-->
<script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://yoursite.com/2019/04/22/my-first-blog/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'http://yoursite.com/2019/04/22/my-first-blog/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
</script>

<script type="text/javascript">
    $('.btn_click_load').click(function() {  //click to load comments
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document;
            var s = d.createElement('script');
            s.src = '//http-miccall-tech.disqus.com/embed.js';
            s.setAttribute('data-timestamp', + new Date());
            (d.head || d.body).appendChild(s);
        })();
        $('.btn_click_load').css('display','none');
    });
</script>
</div>
<style>
    #disqus-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>


        </div>
        <!-- Copyright 版权 start -->
                <div id="copyright">
            <ul>
                <li>&copy;Powered By <a href="https://hexo.io/zh-cn/" style="border-bottom: none;">hexo</a></li>
                <li>Design: <a href="http://miccall.tech " style="border-bottom: none;">miccall</a></li>
            </ul>
            
                <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
			
        </div>
    </div>
</body>



 	
</html>
